Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 222, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 278, in result_update_local
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 323, in update
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:24:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:25:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:26:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 12:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:27:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:29:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:30:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:31:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 12:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-01-30 13:00:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 70, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:32:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:33:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:34:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:35:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:36:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 12:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:37:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:38:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:39:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 12:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 12:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:50:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:51:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 12:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:52:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:53:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:54:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:55:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:56:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:57:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:58:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 12:59:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:00:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:01:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-01-30 13:30:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 70, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:02:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:03:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:04:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:05:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:06:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:07:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:08:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:09:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:10:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:11:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:12:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:13:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:14:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:15:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:16:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:17:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:18:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:19:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:20:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:21:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:24:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:25:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:26:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:27:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:29:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:30:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:31:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-01-30 14:00:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 70, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:32:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:33:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:34:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:35:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:36:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:37:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:38:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:39:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:50:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:51:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 13:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:52:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:53:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:54:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:55:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:56:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 14:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:57:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:58:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 13:59:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 14:00:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 14:01:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-01-30 14:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 68, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-01-30 14:30:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 70, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 14:02:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 14:03:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 14:04:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-01-30 14:05:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 66, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 186, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:24:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:25:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:26:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:29:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:31:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:50:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:51:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:52:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:53:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:54:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:55:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:56:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 13:57:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:00:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:01:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-01 14:30:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 70, in <lambda>
    sched.add_job(lambda: long_term_operation.run(microgrid_long, session_long),'cron', minute='*/30', second='30')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
    long_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
    microgrid = InputCheck.model_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
    if len(model["Load_ac"]["PD"]) != T:
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:02:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:03:55 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
    **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 722, in create_connection
    raise err
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 36, in measurement_data
    if session.query(resource_management).filter(resource_management.TIME_STAMP==t0).count() == 0:
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
    return self.from_self(col).scalar()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
    ret = self.one()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
    ret = self.one_or_none()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
    ret = list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:04:00 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
    **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 722, in create_connection
    raise err
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 36, in measurement_data
    if session.query(resource_management).filter(resource_management.TIME_STAMP==t0).count() == 0:
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
    return self.from_self(col).scalar()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
    ret = self.one()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
    ret = self.one_or_none()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
    ret = list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:04:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
    **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 722, in create_connection
    raise err
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 36, in measurement_data
    if session.query(resource_management).filter(resource_management.TIME_STAMP==t0).count() == 0:
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
    return self.from_self(col).scalar()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
    ret = self.one()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
    ret = self.one_or_none()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
    ret = list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:05:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
    **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 722, in create_connection
    raise err
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 191, in short_term_operation
    local_mg = status_update(local_mg, session, Target_time)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 364, in status_update
    row = session.query(db_real_time).filter( db_real_time. TIME_STAMP < Target_time).all()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2726, in all
    return list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:04:10 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
    **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 722, in create_connection
    raise err
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 36, in measurement_data
    if session.query(resource_management).filter(resource_management.TIME_STAMP==t0).count() == 0:
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
    return self.from_self(col).scalar()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
    ret = self.one()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
    ret = self.one_or_none()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
    ret = list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:04:15 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
    **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 722, in create_connection
    raise err
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 36, in measurement_data
    if session.query(resource_management).filter(resource_management.TIME_STAMP==t0).count() == 0:
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
    return self.from_self(col).scalar()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
    ret = self.one()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
    ret = self.one_or_none()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
    ret = list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:09:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:10:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:11:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:12:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:13:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:18:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:20:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:21:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:27:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:29:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:30:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:31:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:32:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:33:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:34:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 226, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:33:50 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 43, in measurement_data
    row_source = session_source.query(one_minute_history_data).filter_by(TIME_STAMP=Target_time).first()# By using the default data to test the system
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:33:55 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 43, in measurement_data
    row_source = session_source.query(one_minute_history_data).filter_by(TIME_STAMP=Target_time).first()# By using the default data to test the system
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:34:00 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 43, in measurement_data
    row_source = session_source.query(one_minute_history_data).filter_by(TIME_STAMP=Target_time).first()# By using the default data to test the system
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:34:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 43, in measurement_data
    row_source = session_source.query(one_minute_history_data).filter_by(TIME_STAMP=Target_time).first()# By using the default data to test the system
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 14:35:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 192, in short_term_operation
    local_mg = status_update(local_mg, session, Target_time)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 365, in status_update
    row = session.query(db_real_time).filter( db_real_time. TIME_STAMP < Target_time).all()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2726, in all
    return list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:34:10 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 43, in measurement_data
    row_source = session_source.query(one_minute_history_data).filter_by(TIME_STAMP=Target_time).first()# By using the default data to test the system
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:34:15 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 43, in measurement_data
    row_source = session_source.query(one_minute_history_data).filter_by(TIME_STAMP=Target_time).first()# By using the default data to test the system
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:34:20 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 43, in measurement_data
    row_source = session_source.query(one_minute_history_data).filter_by(TIME_STAMP=Target_time).first()# By using the default data to test the system
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 14:34:25 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1040, 'Too many connections')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 64, in <lambda>
    sched.add_job(lambda: real_time_simulation.run(microgrid, session, session),'cron', minute='0-59', second='*/5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/app.py", line 23, in run
    microgrid = measurement_data(microgrid, session_rtc , t0)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/real_time_operation/main.py", line 43, in measurement_data
    row_source = session_source.query(one_minute_history_data).filter_by(TIME_STAMP=Target_time).first()# By using the default data to test the system
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
    conn = bind.contextual_connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
    e, dialect, self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
    return fn()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
    return _ConnectionFairy._checkout(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
    rec = pool._do_get()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
    self._dec_overflow()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
    raise value
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
    return self._create_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
    return _ConnectionRecord(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
    self.__connect(first_connect_check=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
    connection = pool._invoke_creator(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
    return Connection(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
    self.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 935, in connect
    self._get_server_information()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1249, in _get_server_information
    packet = self._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1040, 'Too many connections') (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 16:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 17:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 17:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 17:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 17:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 17:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 17:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 17:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 17:30:01 +08)" was missed by 0:00:04.796570
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 17:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 17:58:40 +08)" was missed by 0:00:01.739974
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-01 18:00:30 +08)" was missed by 0:28:06.740167
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 17:59:01 +08)" was missed by 0:00:35.740296
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:00:05 +08)" was missed by 0:03:31.740400
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 18:13:15 +08)" was missed by 0:00:03.094258
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-01 18:14:01 +08)" was missed by 0:00:12.094485
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:15:05 +08)" was missed by 0:03:08.094572
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-01 18:30:30 +08)" was missed by 0:12:43.094655
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-01 18:13:20 +08)" was missed by 0:00:01.184747
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 18:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 19:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 19:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 19:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 19:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 19:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 19:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-01 19:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 10:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:20:01 +08)" was missed by 0:00:44.930129
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 12:19:50 +08)" was missed by 0:00:01.057747
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 12:20:05 +08)" was missed by 0:04:41.058104
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-02 12:30:30 +08)" was missed by 0:19:16.058217
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:23:01 +08)" was missed by 0:00:34.920692
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 12:22:45 +08)" was missed by 0:00:01.610701
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:33:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:34:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:35:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:36:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:37:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:38:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:39:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 12:59:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 223, in short_term_operation
    local_mg = result_update_local(res_recovery.value, local_mg, "Infeasible",mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 279, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 324, in update
    microgrid["DG"]["COMMAND_PG"] = int(x[PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:00:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:01:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1125, in _execute_context
    conn = self._revalidate_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 427, in _revalidate_connection
    "Can't reconnect until invalid "
sqlalchemy.exc.InvalidRequestError: Can't reconnect until invalid transaction is rolled back

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 192, in short_term_operation
    local_mg = status_update(local_mg, session, Target_time)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 365, in status_update
    row = session.query(db_real_time).filter( db_real_time. TIME_STAMP < Target_time).all()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2726, in all
    return list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2901, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1132, in _execute_context
    None, None)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1125, in _execute_context
    conn = self._revalidate_connection()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 427, in _revalidate_connection
    "Can't reconnect until invalid "
sqlalchemy.exc.StatementError: (sqlalchemy.exc.InvalidRequestError) Can't reconnect until invalid transaction is rolled back [SQL: 'SELECT real_time_operation.`TIME_STAMP` AS `real_time_operation_TIME_STAMP`, real_time_operation.`AC_PD` AS `real_time_operation_AC_PD`, real_time_operation.`AC_QD` AS `real_time_operation_AC_QD`, real_time_operation.`NAC_PD` AS `real_time_operation_NAC_PD`, real_time_operation.`NAC_QD` AS `real_time_operation_NAC_QD`, real_time_operation.`DC_PD` AS `real_time_operation_DC_PD`, real_time_operation.`NDC_PD` AS `real_time_operation_NDC_PD`, real_time_operation.`PV_PG` AS `real_time_operation_PV_PG`, real_time_operation.`WP_PG` AS `real_time_operation_WP_PG`, real_time_operation.`DG_STATUS` AS `real_time_operation_DG_STATUS`, real_time_operation.`DG_PG` AS `real_time_operation_DG_PG`, real_time_operation.`DG_QG` AS `real_time_operation_DG_QG`, real_time_operation.`UG_STATUS` AS `real_time_operation_UG_STATUS`, real_time_operation.`UG_PG` AS `real_time_operation_UG_PG`, real_time_operation.`UG_QG` AS `real_time_operation_UG_QG`, real_time_operation.`BIC_PG` AS `real_time_operation_BIC_PG`, real_time_operation.`BIC_QG` AS `real_time_operation_BIC_QG`, real_time_operation.`BAT_PG` AS `real_time_operation_BAT_PG`, real_time_operation.`BAT_SOC` AS `real_time_operation_BAT_SOC`, real_time_operation.`PMG` AS `real_time_operation_PMG`, real_time_operation.`V_DC` AS `real_time_operation_V_DC`, real_time_operation.`PV_CURT` AS `real_time_operation_PV_CURT`, real_time_operation.`WP_CURT` AS `real_time_operation_WP_CURT`, real_time_operation.`AC_SHED` AS `real_time_operation_AC_SHED`, real_time_operation.`NAC_SHED` AS `real_time_operation_NAC_SHED`, real_time_operation.`DC_SHED` AS `real_time_operation_DC_SHED`, real_time_operation.`NDC_SHED` AS `real_time_operation_NDC_SHED`, real_time_operation.`COST` AS `real_time_operation_COST` \nFROM real_time_operation \nWHERE real_time_operation.`TIME_STAMP` < %(TIME_STAMP_1)s'] [parameters: [{}]]
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:51:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:52:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:55:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:56:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 13:57:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
    short_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 227, in short_term_operation
    local_mg = OutputCheck.output_local_check(local_mg)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/output_check.py", line 27, in output_local_check
    logger.info(model["UG"]["COMMAND_PG"] + model["DG"]["COMMAND_PG"] - model["BIC"]["COMMAND_AC2DC"] + model["BIC"]["COMMAND_DC2AC"] * model["BIC"]["EFF_DC2AC"] - model["Load_ac"]["PD"] - model["Load_uac"]["PD"])
KeyError: 'Load_uac'
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 14:50:05 +08)" was missed by 0:00:02.009391
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 14:51:01 +08)" was missed by 0:00:01.009656
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 16:46:35 +08)" was missed by 0:00:02.156429
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 16:47:01 +08)" was missed by 0:00:31.174988
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 16:50:05 +08)" was missed by 0:01:27.178618
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-02 17:00:30 +08)" was missed by 0:16:02.178812
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 16:46:50 +08)" was missed by 0:00:01.070104
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 16:54:05 +08)" was missed by 0:00:04.015434
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 16:55:01 +08)" was missed by 0:00:03.015730
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 18:19:15 +08)" was missed by 0:00:02.852354
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 18:20:01 +08)" was missed by 0:00:11.855915
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 18:20:05 +08)" was missed by 0:04:07.856092
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-02 18:30:30 +08)" was missed by 0:18:42.856194
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 18:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 18:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 18:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 18:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 18:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 18:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 18:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 19:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 19:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 19:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 19:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 19:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 19:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 19:51:45 +08)" was missed by 0:00:02.894468
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 19:52:01 +08)" was missed by 0:00:41.894662
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 19:55:05 +08)" was missed by 0:01:37.894739
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-02 20:00:30 +08)" was missed by 0:21:12.894807
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 20:27:40 +08)" was missed by 0:00:04.895137
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 20:28:01 +08)" was missed by 0:00:38.895393
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 20:30:05 +08)" was missed by 0:02:34.895481
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-02 20:30:30 +08)" was missed by 0:27:09.895560
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 21:01:20 +08)" was missed by 0:00:01.966412
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 21:02:01 +08)" was missed by 0:00:15.966617
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 21:05:05 +08)" was missed by 0:01:11.966712
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-02 21:30:30 +08)" was missed by 0:00:46.966784
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 22:07:40 +08)" was missed by 0:00:01.512519
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:08:01 +08)" was missed by 0:00:35.512923
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 22:10:05 +08)" was missed by 0:02:31.513037
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-02 22:30:30 +08)" was missed by 0:07:06.513145
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 22:18:45 +08)" was missed by 0:00:01.802717
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:19:01 +08)" was missed by 0:00:40.802992
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 22:20:05 +08)" was missed by 0:03:36.803118
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:51:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 223, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 279, in result_update_local
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 324, in update
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 22:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:52:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:53:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:54:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:55:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:56:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:57:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:58:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 22:59:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:00:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:01:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-02 23:30:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 70, in <lambda>
    sched.add_job(lambda: long_term_operation.run(microgrid_long, session_long),'cron', minute='*/30', second='30')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:02:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:03:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:04:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:05:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:06:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:07:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:08:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:09:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:10:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:11:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:12:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:13:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:14:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:15:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:16:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:17:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:18:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:19:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:20:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:21:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:24:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:25:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:26:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 68, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:27:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 66, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 31, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:34:01 +08)" was missed by 0:00:29.654863
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:35:05 +08)" was missed by 0:03:25.655058
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-03 00:00:30 +08)" was missed by 0:03:00.655141
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-02 23:35:15 +08)" was missed by 0:00:01.644263
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-02 23:36:01 +08)" was missed by 0:00:10.644649
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-02 23:40:05 +08)" was missed by 0:00:06.644990
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-03 13:03:50 +08)" was missed by 0:00:02.277034
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 13:04:01 +08)" was missed by 0:00:46.283159
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 13:05:05 +08)" was missed by 0:03:42.283359
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-03 13:30:30 +08)" was missed by 0:03:17.284681
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-03 13:12:20 +08)" was missed by 0:00:03.331797
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 13:13:01 +08)" was missed by 0:00:17.332037
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 13:15:05 +08)" was missed by 0:02:13.332131
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-03 13:13:35 +08)" was missed by 0:00:04.278295
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='0-59', second='*/5'], next run at: 2018-02-03 13:13:45 +08)" was missed by 0:00:02.843282
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:03:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 223, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 279, in result_update_local
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 324, in update
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:04:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:05:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:06:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 16:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 76, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:07:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:08:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:09:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:10:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 16:11:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 74, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 16:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 920, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 704, in create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/socket.py", line 743, in getaddrinfo
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
  File "local_ems.py", line 76, in <lambda>
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 409, in _connection_for_bind
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2123, in contextual_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2162, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1476, in _handle_dbapi_exception_noconnection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2158, in _wrap_pool_connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 403, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 782, in _checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 532, in checkout
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1186, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 66, in __exit__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 187, in reraise
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 1183, in _do_get
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 350, in _create_connection
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 477, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/pool.py", line 667, in __connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 105, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 410, in connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/__init__.py", line 90, in Connect
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 699, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 967, in connect
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 8] nodename nor servname provided, or not known)") (Background on this error at: http://sqlalche.me/e/e3q8)
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 17:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 17:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 17:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 17:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 17:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 17:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 17:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 18:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 19:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:11:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 223, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 279, in result_update_local
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 324, in update
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:12:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:13:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:14:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:15:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:16:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:17:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:18:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:19:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:20:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:21:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:24:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:25:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:26:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:27:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:29:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:30:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:31:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-03 21:00:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 78, in <lambda>
    sched.add_job(lambda: long_term_operation.run(microgrid_long, session_long,session_history_data_long),'cron', minute='*/30', second='30')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:32:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:33:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:34:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:35:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:36:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:37:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:38:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:39:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:50:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:51:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 20:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:52:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:53:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:54:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:55:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:56:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 21:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:57:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:58:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 20:59:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:00:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:01:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 21:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-03 21:30:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 78, in <lambda>
    sched.add_job(lambda: long_term_operation.run(microgrid_long, session_long,session_history_data_long),'cron', minute='*/30', second='30')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:02:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:03:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:04:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:05:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:06:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 21:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:07:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:08:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:09:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:10:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:11:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 21:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:12:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:13:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:14:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:15:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:16:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 21:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:17:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:18:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:19:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:20:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:21:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 21:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:24:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:25:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:26:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 21:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:27:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:29:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:30:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:31:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-03 21:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-03 22:00:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 78, in <lambda>
    sched.add_job(lambda: long_term_operation.run(microgrid_long, session_long,session_history_data_long),'cron', minute='*/30', second='30')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:32:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-03 21:33:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 15:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 15:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 15:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 15:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 15:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 15:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 15:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 16:37:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 223, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 279, in result_update_local
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 324, in update
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 16:38:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 16:39:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 16:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 16:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 16:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 17:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 18:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 19:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:00:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:10:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:10:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 223, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 279, in result_update_local
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 324, in update
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:11:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:15:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:12:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:13:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:14:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:15:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:16:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:20:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:17:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:18:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:19:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:20:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:21:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:25:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:24:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:25:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:26:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:30:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:27:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:29:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:30:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:31:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:35:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-04 21:00:30 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 78, in <lambda>
    sched.add_job(lambda: long_term_operation.run(microgrid_long, session_long,session_history_data_long),'cron', minute='*/30', second='30')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/app.py", line 19, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/main.py", line 190, in long_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/long_term_operation/input_check.py", line 122, in model_local_check
TypeError: object of type 'int' has no len()
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:32:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:33:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:34:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:35:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:36:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:40:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:37:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:38:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:39:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:45:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:50:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:50:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:51:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-04 20:55:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 76, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 229, in middle_term_operation
    microgrid = result_update_local(res_recovery.value, microgrid,"Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 282, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 389, in update
    model["DG"]["COMMAND_PG"][i] = int(x[i * NX + PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:52:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:53:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 20:54:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 187, in short_term_operation
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/forecasting/app.py", line 32, in __init__
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/utils/__init__.py", line 43, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/logging/__init__.py", line 1020, in __init__
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py", line 374, in abspath
OSError: [Errno 24] Too many open files
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 21:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 507, in do_execute
    cursor.execute(statement, parameters)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/cursors.py", line 165, in execute
    result = self._query(query)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/cursors.py", line 321, in _query
    conn.query(q)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 860, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1061, in _read_query_result
    result.read()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1349, in read
    first_packet = self.connection._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'microgrid_db_local.rm_status' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 74, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 204, in short_term_operation
    local_mg = real_time_information_update(local_mg, session)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 405, in real_time_information_update
    row = session.query(RMDBData).filter_by(datetime1=Target_time).first()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2778, in first
    ret = list(self[0:1])
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2570, in __getitem__
    return list(res)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2901, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 186, in reraise
    raise value.with_traceback(tb)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 507, in do_execute
    cursor.execute(statement, parameters)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/cursors.py", line 165, in execute
    result = self._query(query)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/cursors.py", line 321, in _query
    conn.query(q)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 860, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1061, in _read_query_result
    result.read()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1349, in read
    first_packet = self.connection._read_packet()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 1018, in _read_packet
    packet.check_error()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/connections.py", line 384, in check_error
    err.raise_mysql_exception(self._data)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/pymysql/err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'microgrid_db_local.rm_status' doesn't exist") [SQL: 'SELECT rm_status.id AS rm_status_id, rm_status.name AS rm_status_name, rm_status.datetime1 AS rm_status_datetime1, rm_status.`PV0_1_VOL` AS `rm_status_PV0_1_VOL`, rm_status.`PV0_2_VOL` AS `rm_status_PV0_2_VOL`, rm_status.`PV0_3_VOL` AS `rm_status_PV0_3_VOL`, rm_status.`PV1_1_VOL` AS `rm_status_PV1_1_VOL`, rm_status.`PV1_2_VOL` AS `rm_status_PV1_2_VOL`, rm_status.`PV1_3_VOL` AS `rm_status_PV1_3_VOL`, rm_status.`BAT_VOL` AS `rm_status_BAT_VOL`, rm_status.`BAT_CURR` AS `rm_status_BAT_CURR`, rm_status.`BAT_POW` AS `rm_status_BAT_POW`, rm_status.`LOAD_DC_CT_VOL` AS `rm_status_LOAD_DC_CT_VOL`, rm_status.`LOAD_DC_CT_CURR` AS `rm_status_LOAD_DC_CT_CURR`, rm_status.`LOAD_DC_CT_POW` AS `rm_status_LOAD_DC_CT_POW`, rm_status.`LOAD_DC_NCT_VOL` AS `rm_status_LOAD_DC_NCT_VOL`, rm_status.`LOAD_DC_NCT_CURR` AS `rm_status_LOAD_DC_NCT_CURR`, rm_status.`LOAD_DC_NCT_POW` AS `rm_status_LOAD_DC_NCT_POW`, rm_status.`LOAD_AC3P_CT_VOL` AS `rm_status_LOAD_AC3P_CT_VOL`, rm_status.`LOAD_AC3P_CT_ACTPOW` AS `rm_status_LOAD_AC3P_CT_ACTPOW`, rm_status.`LOAD_AC3P_CT_REACTPOW` AS `rm_status_LOAD_AC3P_CT_REACTPOW`, rm_status.`LOAD_AC3P_NCT_VOL` AS `rm_status_LOAD_AC3P_NCT_VOL`, rm_status.`LOAD_AC3P_NCT_ACTPOW` AS `rm_status_LOAD_AC3P_NCT_ACTPOW`, rm_status.`LOAD_AC3P_NCT_REACTPOW` AS `rm_status_LOAD_AC3P_NCT_REACTPOW`, rm_status.`DC_OUTLET_VOL` AS `rm_status_DC_OUTLET_VOL`, rm_status.`DC_OUTLET_CURR` AS `rm_status_DC_OUTLET_CURR`, rm_status.`DC_OUTLET_POW` AS `rm_status_DC_OUTLET_POW`, rm_status.`AC_OUTLET_VOL_U` AS `rm_status_AC_OUTLET_VOL_U`, rm_status.`AC_OUTLET_VOL_V` AS `rm_status_AC_OUTLET_VOL_V`, rm_status.`AC_OUTLET_VOL_W` AS `rm_status_AC_OUTLET_VOL_W`, rm_status.`AC_OUTLET_CURR_U` AS `rm_status_AC_OUTLET_CURR_U`, rm_status.`AC_OUTLET_CURR_V` AS `rm_status_AC_OUTLET_CURR_V`, rm_status.`AC_OUTLET_FREQ` AS `rm_status_AC_OUTLET_FREQ`, rm_status.`AC_OUTLET_ACTPOW` AS `rm_status_AC_OUTLET_ACTPOW`, rm_status.`AC_OUTLET_REACTPOW` AS `rm_status_AC_OUTLET_REACTPOW`, rm_status.`GRID_VOL_U` AS `rm_status_GRID_VOL_U`, rm_status.`GRID_VOL_V` AS `rm_status_GRID_VOL_V`, rm_status.`GRID_VOL_W` AS `rm_status_GRID_VOL_W`, rm_status.`GRID_CURR_U` AS `rm_status_GRID_CURR_U`, rm_status.`GRID_CURR_V` AS `rm_status_GRID_CURR_V`, rm_status.`GRID_CURR_W` AS `rm_status_GRID_CURR_W`, rm_status.`GRID_FREQ` AS `rm_status_GRID_FREQ`, rm_status.`GRID_ACTPOW` AS `rm_status_GRID_ACTPOW`, rm_status.`GRID_REACTPOW` AS `rm_status_GRID_REACTPOW`, rm_status.`DG_VOL_U` AS `rm_status_DG_VOL_U`, rm_status.`DG_VOL_V` AS `rm_status_DG_VOL_V`, rm_status.`DG_VOL_W` AS `rm_status_DG_VOL_W`, rm_status.`DG_CURR_U` AS `rm_status_DG_CURR_U`, rm_status.`DG_CURR_V` AS `rm_status_DG_CURR_V`, rm_status.`DG_CURR_W` AS `rm_status_DG_CURR_W`, rm_status.`DG_FREQ` AS `rm_status_DG_FREQ`, rm_status.`DG_ACTPOW` AS `rm_status_DG_ACTPOW`, rm_status.`DG_REACTPOW` AS `rm_status_DG_REACTPOW`, rm_status.`DC_VOL` AS `rm_status_DC_VOL`, rm_status.`AC_VOL` AS `rm_status_AC_VOL`, rm_status.`AC_FREQ` AS `rm_status_AC_FREQ`, rm_status.`TEMP_A` AS `rm_status_TEMP_A`, rm_status.`TEMP_B` AS `rm_status_TEMP_B`, rm_status.`TEMP_C` AS `rm_status_TEMP_C`, rm_status.`RM_REALY_STATUS_0` AS `rm_status_RM_REALY_STATUS_0`, rm_status.`RM_REALY_STATUS_1` AS `rm_status_RM_REALY_STATUS_1`, rm_status.`DC_IS_STABLE` AS `rm_status_DC_IS_STABLE`, rm_status.`AC_IS_STABLE` AS `rm_status_AC_IS_STABLE`, rm_status.`AC_FREQ_STABLE` AS `rm_status_AC_FREQ_STABLE`, rm_status.`AC_OUTLET_DIR` AS `rm_status_AC_OUTLET_DIR`, rm_status.`GRID_DIR` AS `rm_status_GRID_DIR`, rm_status.`DG_DIR` AS `rm_status_DG_DIR`, rm_status.`PV0_CH1_MODE` AS `rm_status_PV0_CH1_MODE`, rm_status.`PV0_CH2_MODE` AS `rm_status_PV0_CH2_MODE`, rm_status.`PV0_CH3_MODE` AS `rm_status_PV0_CH3_MODE`, rm_status.`PV1_CH1_MODE` AS `rm_status_PV1_CH1_MODE`, rm_status.`PV1_CH2_MODE` AS `rm_status_PV1_CH2_MODE`, rm_status.`PV1_CH3_MODE` AS `rm_status_PV1_CH3_MODE`, rm_status.`PV0_1_POW` AS `rm_status_PV0_1_POW`, rm_status.`PV0_2_POW` AS `rm_status_PV0_2_POW`, rm_status.`PV0_3_POW` AS `rm_status_PV0_3_POW`, rm_status.`PV1_1_POW` AS `rm_status_PV1_1_POW`, rm_status.`PV1_2_POW` AS `rm_status_PV1_2_POW`, rm_status.`PV1_3_POW` AS `rm_status_PV1_3_POW`, rm_status.`BIC_isolate_status` AS `rm_status_BIC_isolate_status`, rm_status.`BAT_SOC` AS `rm_status_BAT_SOC`, rm_status.`WT_MODE` AS `rm_status_WT_MODE`, rm_status.`BAT_MODE` AS `rm_status_BAT_MODE`, rm_status.`AC_OUTLET_CURR_W` AS `rm_status_AC_OUTLET_CURR_W`, rm_status.`BIC_AC_output_active_power` AS `rm_status_BIC_AC_output_active_power`, rm_status.`BIC_AC_output_reactive_power` AS `rm_status_BIC_AC_output_reactive_power`, rm_status.`WT_POW` AS `rm_status_WT_POW` \nFROM rm_status \nWHERE rm_status.datetime1 = %(datetime1_1)s \n LIMIT %(param_1)s'] [parameters: {'datetime1_1': '2018-02-04 21:21:00', 'param_1': 1}] (Background on this error at: http://sqlalche.me/e/f405)
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-04 22:15:01 +08)" was missed by 0:00:37.688982
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 00:11:01 +08)" was missed by 0:00:47.129171
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 00:15:05 +08)" was missed by 0:00:43.129416
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 00:30:30 +08)" was missed by 0:10:18.129530
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 00:33:01 +08)" was missed by 0:00:24.616315
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 00:35:05 +08)" was missed by 0:02:20.616552
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 01:00:30 +08)" was missed by 0:01:55.616644
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 01:11:01 +08)" was missed by 0:00:47.988397
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 01:15:05 +08)" was missed by 0:00:43.988623
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 01:30:30 +08)" was missed by 0:10:18.988706
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 01:12:01 +08)" was missed by 0:00:04.010763
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 01:45:01 +08)" was missed by 0:00:49.988738
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 01:45:05 +08)" was missed by 0:04:45.988971
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 02:00:30 +08)" was missed by 0:14:20.989063
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 02:10:01 +08)" was missed by 0:00:20.007803
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 02:10:05 +08)" was missed by 0:04:16.008051
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 02:30:30 +08)" was missed by 0:08:51.008143
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 02:35:01 +08)" was missed by 0:00:47.023175
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 02:35:05 +08)" was missed by 0:04:43.023408
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 03:00:30 +08)" was missed by 0:04:18.023499
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 03:19:01 +08)" was missed by 0:00:31.011138
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 03:20:05 +08)" was missed by 0:03:27.011374
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 03:30:30 +08)" was missed by 0:18:02.011459
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 03:57:01 +08)" was missed by 0:00:03.028270
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 04:00:05 +08)" was missed by 0:00:59.028494
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 04:00:30 +08)" was missed by 0:25:34.028577
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 04:11:01 +08)" was missed by 0:00:11.010931
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 04:15:05 +08)" was missed by 0:00:07.011166
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 04:30:30 +08)" was missed by 0:09:42.011257
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 05:10:01 +08)" was missed by 0:00:15.913648
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 05:10:05 +08)" was missed by 0:04:11.913869
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 05:30:30 +08)" was missed by 0:08:46.913951
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 06:08:01 +08)" was missed by 0:00:20.640550
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 06:10:05 +08)" was missed by 0:02:16.640804
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 06:30:30 +08)" was missed by 0:06:51.640915
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 07:07:01 +08)" was missed by 0:00:32.992754
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 07:10:05 +08)" was missed by 0:01:28.992981
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 07:30:30 +08)" was missed by 0:06:03.993063
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 07:46:01 +08)" was missed by 0:00:17.420389
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 07:50:05 +08)" was missed by 0:00:13.420611
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 08:00:30 +08)" was missed by 0:14:48.420693
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 09:53:01 +08)" was missed by 0:00:09.757922
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 09:55:05 +08)" was missed by 0:02:05.758191
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 10:00:30 +08)" was missed by 0:21:40.758297
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 09:54:01 +08)" was missed by 0:00:47.395402
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 13:12:01 +08)" was missed by 0:00:24.772738
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 13:15:05 +08)" was missed by 0:01:20.772989
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-05 13:30:30 +08)" was missed by 0:10:55.773072
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 13:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 236, in short_term_operation
    local_mg = result_update_local(res_recovery.value, local_mg, "Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 293, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 341, in update
    microgrid["DG"]["COMMAND_PG"] = int(x[PG])
TypeError: 'int' object is not subscriptable
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 13:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 236, in short_term_operation
    local_mg = result_update_local(res_recovery.value, local_mg, "Infeasible", mathematical_model_recovery)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 293, in result_update_local
    local_model = update(x_local, local_model, type)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 341, in update
    microgrid["DG"]["COMMAND_PG"] = int(x[PG])
TypeError: 'int' object is not subscriptable
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-05 14:53:01 +08)" was missed by 0:00:25.798084
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 14:55:05 +08)" was missed by 0:02:21.798492
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='5'], next run at: 2018-02-05 16:05:05 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 77, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='5')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 232, in middle_term_operation
    microgrid = OutputCheck.output_local_check(microgrid)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/output_check.py", line 57, in output_local_check
    model["Load_ac"]["COMMAND_SHED"][i] + model["Load_nac"]["COMMAND_SHED"][i])
KeyError: 'Load_uac'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:35:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:36:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:37:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:38:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:39:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:50:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:51:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:52:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:53:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:54:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:55:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:56:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:57:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:58:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 09:59:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:00:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:01:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:02:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:03:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:04:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:05:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:06:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:07:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:08:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:09:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:10:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:11:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:12:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='1')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:13:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:14:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:15:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:16:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:17:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:18:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:19:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:20:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:21:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:22:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:23:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:24:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:25:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:26:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:27:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:28:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:29:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:30:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:31:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:32:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:33:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:34:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:35:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:36:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:37:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:38:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:39:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:40:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:41:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:42:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:43:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:44:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:45:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:46:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:47:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:48:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='1'], next run at: 2018-02-07 10:49:01 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 75, in <lambda>
    sched.add_job(lambda: short_term_operation.run(microgrid_short, session_short,session_history_data_short,session_real_time),'cron', minute='*/1', second='40')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/app.py", line 21, in run
    short_term_operation(micorgird, session, session_history, session_real_time,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/main.py", line 206, in short_term_operation
    local_mg = InputCheckShortTerm.model_local_check(local_mg)  # Check the data format of local ems
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/short_term_operation/input_check.py", line 126, in model_local_check
    if model["PV"]["PD"] > model["PV"]["SMAX"] or model["PV"]["PD"] <- model["PV"]["SMAX"]:
KeyError: 'PD'
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='10'], next run at: 2018-02-08 09:45:10 +08)" was missed by 0:00:35.998047
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-02-08 09:41:30 +08)" was missed by 0:00:15.998321
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-02-08 10:00:30 +08)" was missed by 0:10:15.998429
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-02-08 09:45:30 +08)" was missed by 0:00:12.794641
Job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='10'], next run at: 2018-02-08 09:50:10 +08)" raised an exception
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "local_ems.py", line 89, in <lambda>
    sched.add_job(lambda: middle_term_operation.run(microgrid_middle, session_middle,session_history_data_middle),'cron', minute='*/5', second='10')
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/app.py", line 19, in run
    middle_term_operation(micorgird,session,session_history,self.logger)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 200, in middle_term_operation
    microgrid = status_update(microgrid, session, Target_time)
  File "/Users/tianyangzhao/PycharmProjects/microgrid_energy_management_system/middle_term_operation/main.py", line 430, in status_update
    if session.query(db_short_term).filter(db_short_term.TIME_STAMP == Target_time).count() !=0:
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 3113, in count
    return self.from_self(col).scalar()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2866, in scalar
    ret = self.one()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2837, in one
    ret = self.one_or_none()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2807, in one_or_none
    ret = list(self)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2878, in __iter__
    return self._execute_and_instances(context)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2899, in _execute_and_instances
    close_with_result=True)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2908, in _get_bind_args
    **kw
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/query.py", line 2890, in _connection_from_session
    conn = self.session.connection(**kw)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1035, in connection
    execution_options=execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1040, in _connection_for_bind
    engine, execution_options)
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 388, in _connection_for_bind
    self._assert_active()
  File "/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 276, in _assert_active
    % self._rollback_exception
sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (pymysql.err.IntegrityError) (1062, "Duplicate entry '1518057900' for key 'PRIMARY'") [SQL: 'INSERT INTO mid_term_forecasting (`TIME_STAMP`, `AC_PD`, `NAC_PD`, `DC_PD`, `NDC_PD`, `PV_PG`, `WP_PG`, `PRICE`) VALUES (%(TIME_STAMP)s, %(AC_PD)s, %(NAC_PD)s, %(DC_PD)s, %(NDC_PD)s, %(PV_PG)s, %(WP_PG)s, %(PRICE)s)'] [parameters: {'TIME_STAMP': 1518057900, 'AC_PD': 0, 'NAC_PD': 0, 'DC_PD': 0, 'NDC_PD': 0, 'PV_PG': 0, 'WP_PG': 0, 'PRICE': 0}] (Background on this error at: http://sqlalche.me/e/gkpj)
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-02-08 10:18:30 +08)" was missed by 0:00:20.225237
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='10'], next run at: 2018-02-08 10:20:10 +08)" was missed by 0:02:40.225627
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-02-08 11:23:30 +08)" was missed by 0:00:57.233206
Execution of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-07 15:37:30 +08)" skipped: maximum number of running instances reached (1)
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-07 16:46:30 +08)" was missed by 0:00:20.948094
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='10'], next run at: 2018-03-07 16:50:10 +08)" was missed by 0:00:40.948495
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-09 09:59:30 +08)" was missed by 0:00:09.936690
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='10'], next run at: 2018-03-09 10:00:10 +08)" was missed by 0:03:29.937092
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-09 10:18:30 +08)" was missed by 0:00:58.689238
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-09 10:26:30 +08)" was missed by 0:00:07.310645
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='10'], next run at: 2018-03-09 10:30:10 +08)" was missed by 0:00:27.310999
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-09 15:55:30 +08)" was missed by 0:00:05.907583
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-09 16:08:30 +08)" was missed by 0:00:37.204705
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='10'], next run at: 2018-03-09 16:10:10 +08)" was missed by 0:02:57.204956
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-03-09 16:30:30 +08)" was missed by 0:07:37.205040
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-09 16:09:30 +08)" was missed by 0:00:04.125868
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/1', second='30'], next run at: 2018-03-09 16:33:30 +08)" was missed by 0:00:51.839733
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/5', second='10'], next run at: 2018-03-09 16:35:10 +08)" was missed by 0:03:11.840021
Run time of job "Main.local_ems.<locals>.<lambda> (trigger: cron[minute='*/30', second='30'], next run at: 2018-03-09 17:00:30 +08)" was missed by 0:02:51.840115
